ChronologyConstants class compile: 'initialiseNomDesJours 	DayNames := #(Dimanche Lundi Mardi Mercredi Jeudi Vendredi Samedi)'.	ChronologyConstants initialiseNomDesJours.Date class compile: 'jour: n ^ Date dayNames at: (n rem: 7) +1'. iceo definition: #conte.iceo definitionSituation: #chemin. iceo definitionSituation: #lit.  iceo definition: #role.iceo definitionQualiteEssentielle: #comportement pour: role effectivite: #permanente.  ( role getQualite: #comportement) addInstVarNamed: #sem.(role getQualite: #comportement) compile: 'setSemaphore: unSemaphore sem := unSemaphore'. ( role getQualite: #comportement) compile: 'getSemaphore ^sem'. (role getQualite: #comportement) addInstVarNamed: #process.(role getQualite: #comportement) compile: 'setProcess: unProcess process := unProcess'. (role getQualite: #comportement) compile: 'getProcess ^process'. iceo definitionAttribut: #loup de: conte genus: role cardinalite: 1.  iceo definitionAttribut: #chaperon de: conte genus: role  cardinalite: 1.  iceo definitionAttribut: #mèreGrand de: conte genus: role  cardinalite: 1.  iceo definitionSituation: #santé.iceo definitionQualite: #malade situation: santé.	(conte getEssenceAttribut: #mèreGrand) peutEtre: (santé get: #malade).iceo soit: 'santé de MèreGrand'  situationGenerique: santé.iceo definitionAttribut: #oreille de: (conte getEssenceAttribut: #loup) cardinalite: 2. iceo definitionAttribut: #dent de: (conte getEssenceAttribut: #loup) cardinalite: 42.  iceo definitionSituation: #taille.iceo definitionQualite: #grande situation: taille.	((conte getEssenceAttribut: #loup) getEssenceAttribut: #oreille) peutEtre: (taille get: #grande).((conte getEssenceAttribut: #loup) getEssenceAttribut: #dent) peutEtre: (taille get: #grande).iceo soit: 'taille loup'  situationGenerique: taille.iceo soit: #chemin  situationGenerique: chemin.iceo soit: #litMèreGrand  situationGenerique: lit.iceo soit: #scenario essence: conte."loup_0 possède 2 grandes oreilles et 42 grandes dents !"((monde get: #scenario) getEtreAttribut: #loup_0) getAllEtresAttributs do: [:each | each  affecteEtat: (taille get: #grande) dansSituation: (monde get: 'taille loup')].conte compile: 'go	(((monde get: #scenario) getEtreAttribut: #mèreGrand_0) getEtat: #comportement)  getProcess resume.	(((monde get: #scenario) getEtreAttribut: #loup_0) getEtat: #comportement)  getProcess resume.	(((monde get: #scenario) getEtreAttribut: #chaperon_0) getEtat: #comportement)  getProcess resume.		[(Smalltalk at: #jour) ~~ 15] whileTrue: [		"Transcript cr; show: (Date jour: (Smalltalk at: #jour)), ''('', (Smalltalk at: #jour) asString, '')''.    "		(((monde get: #scenario) getEtreAttribut: #chaperon_0) getEtat: #comportement)  getSemaphore  signal.		(((monde get: #scenario) getEtreAttribut: #loup_0) getEtat: #comportement)  getSemaphore  signal.		(((monde get: #scenario) getEtreAttribut: #mèreGrand_0) getEtat: #comportement)  getSemaphore  signal.		Semaphore new			waitTimeoutMilliseconds: 10			onCompletion: [  ]			onTimeout: [  ] .		Smalltalk at: #jour put: ((Smalltalk at: #jour) +1)].	self fin'.	conte compile: 'fin	(((monde get: #scenario) getEtreAttribut: #mèreGrand_0) getEtat: #comportement) getProcess terminate.	(((monde get: #scenario) getEtreAttribut: #loup_0) getEtat: #comportement) getProcess terminate.	(((monde get: #scenario) getEtreAttribut: #chaperon_0) getEtat: #comportement) getProcess terminate.	ICEO reset '.(((monde get: #scenario) getEtreAttribut: #mèreGrand_0) getEtat: #comportement) setSemaphore: Semaphore new.(((monde get: #scenario) getEtreAttribut: #mèreGrand_0) getEtat: #comportement) setProcess: ([:mg |		 [ true ] whileTrue: [ (mg getEtat: #comportement) getSemaphore wait.					(Smalltalk at: #jour) == 1 ifTrue: [Transcript cr; show:  'MèreGrand - Ah ! J''ai un beau rôle dans cette histoire !'].					(Smalltalk at: #jour) == 4 ifTrue: [						Transcript cr; show:  'MèreGrand - Pour commencer, me voici malade !'.						 ((monde get: #scenario) getEtreAttribut: #mèreGrand_0) affecteEtat: (santé get: #malade) dansSituation: (monde get: 'santé de MèreGrand').						(monde get: #litMèreGrand) introductionEtre: ((monde get: #scenario) getEtreAttribut: #mèreGrand_0)].					(Smalltalk at: #jour) == 12  ifTrue: [						Transcript cr; show:  'MèreGrand - Ouf ! je vais mieux, mais je reste encore au lit'.						 ((monde get: #scenario) getEtreAttribut: #mèreGrand_0) removeEtatDeNom: #malade].		]] newProcessWith:  (Array with: ((monde get: #scenario) getEtreAttribut: #mèreGrand_0))).		(((monde get: #scenario) getEtreAttribut: #loup_0) getEtat: #comportement) setSemaphore: Semaphore new.(((monde get: #scenario) getEtreAttribut: #loup_0) getEtat: #comportement) setProcess: ([:l |		 [ true ] whileTrue: [(l getEtat: #comportement) getSemaphore wait.				((Smalltalk at: #jour) == 13 and: [(Smalltalk at: #step) == 0]) ifTrue: [					Transcript cr; show:  'Loup - OOuuuu ! J''ai bien dormi'; cr; show: 'Loup - J''ai une de ces faims !'.					(monde get: #chemin) introductionEtre: ((monde get: #scenario) getEtreAttribut: #loup_0)].				(Smalltalk at: #jour) == 14 ifTrue: [ 					(Smalltalk at: #step) == 1 ifTrue: [						Transcript cr; show:  'Loup -  Bonjour Chaperon rouge'.						Transcript cr; show:  'Loup -  Tu devrais prendre ce raccourci pour aller voir ta grand mère'.						Smalltalk at: #step put: 2.						(((monde get: #scenario) getEtreAttribut: #chaperon_0) getEtat: #comportement)  getSemaphore  signal].									(Smalltalk at: #step) == 3 ifTrue: [						Transcript cr; show:  'Loup - Je vais vite aller dévorer MèreGrand'.						Transcript cr; show:  'Loup - MèreGrand était un peu coriace'.						Transcript cr; show:  'Loup - Chaperon rouge sera plus tendre'.						Transcript cr; show:  'Loup - Je prends la place de MèreGrand dans son lit'.						(monde get: #litMèreGrand) removeEtreDeNom: #mèreGrand_0.						(monde get: #litMèreGrand) introductionEtre: ((monde get: #scenario) getEtreAttribut: #loup_0).						Smalltalk at: #step put: 4.						(((monde get: #scenario) getEtreAttribut: #chaperon_0) getEtat: #comportement)  getSemaphore  signal].									(Smalltalk at: #step) == 5 ifTrue: [						Transcript cr; show:  'Loup -  C''est pour mieux t''entendre, mon enfant'.						Smalltalk at: #step put: 6.						(((monde get: #scenario) getEtreAttribut: #chaperon_0) getEtat: #comportement)  getSemaphore  signal].									(Smalltalk at: #step) == 7 ifTrue: [						Transcript cr; show:  'Loup -  C''est pour mieux te manger !'].						] ]] newProcessWith:  (Array with: ((monde get: #scenario) getEtreAttribut: #loup_0))).(((monde get: #scenario) getEtreAttribut: #chaperon_0) getEtat: #comportement) setSemaphore: Semaphore new.(((monde get: #scenario) getEtreAttribut: #chaperon_0) getEtat: #comportement) setProcess: ([:c  |		 [ true ] whileTrue: [ (c getEtat: #comportement) getSemaphore wait.			(#( 1 2 3 4 5 6 8 9 10 11 12 13) includes: (Smalltalk at: #jour)) ifTrue: [Transcript cr; show:  'Chaperon rouge - C''est ', (Date jour: (Smalltalk at: #jour)) ,  ' je vais à l''école'].				(Smalltalk at: #jour) == 7 ifTrue: [					Transcript cr; show:  'Chaperon rouge - C''est ' , (Date jour: (Smalltalk at: #jour)), ', je vais voir MèreGrand'.					(monde get: #litMèreGrand) getElements size ~~ 0 ifTrue: [						Transcript cr; show:  'Chaperon rouge - MèreGrand est couchée'.						Transcript cr; show:  'Chaperon rouge - MèreGrand, tu es malade'.						Transcript cr; show:  'Chaperon rouge - MèreGrand, soigne toi bien']].								(Smalltalk at: #jour) == 14 ifTrue: [					(Smalltalk at: #step) == 0 ifTrue: [						Transcript cr; show:  'Chaperon rouge - C''est ' ,(Date jour: (Smalltalk at: #jour)) , ', je vais chez MèreGrand'.						(monde get: #chemin) getElements size ~~ 0 ifTrue: [							Transcript cr; show:    'Chaperon rouge - Sur le chemin qui mène chez MèreGrand, je rencontre ',  ((monde get: #chemin) getElements at: 1) getEssence getNom capitalized.							Transcript cr; show:    'Chaperon rouge - Bonjour Loup. Je vais chez ma grand mère'].							Smalltalk at: #step put: 1.						(((monde get: #scenario) getEtreAttribut: #loup_0) getEtat: #comportement)  getSemaphore  signal].									(Smalltalk at: #step) == 2 ifTrue: [Transcript cr; show:  'Chaperon rouge - Merci Loup'.						Smalltalk at: #step put:  3.						(((monde get: #scenario) getEtreAttribut: #loup_0) getEtat: #comportement)  getSemaphore  signal].									(Smalltalk at: #step) == 4 ifTrue: [						Transcript cr; show:  'Chaperon rouge - Voici enfin la maison de MèreGrand. Quel raccourci ! Merci Loup !'.												((((monde get: #litMèreGrand) getElements at: 1) getEtresAttributs: #oreille)  select:  [:each | (each getEtat: #grande) notNil]) size 							==  (((monde get: #litMèreGrand) getElements at: 1) getEtresAttributs: #oreille) size ifTrue: [													Transcript cr; show:  'Chaperon rouge - Quelquechose a changé chez MèreGrand'.							Transcript cr; show:  'Chaperon rouge - MèreGrand, tu as de grandes oreilles'].						Smalltalk at: #step put:  5.						(((monde get: #scenario) getEtreAttribut: #loup_0) getEtat: #comportement)  getSemaphore  signal].									(Smalltalk at: #step) == 6 ifTrue: [						((((monde get: #litMèreGrand) getElements at: 1) getEtresAttributs: #dent)  select:  [:each | (each getEtat: #grande) notNil]) size 							==  (((monde get: #litMèreGrand) getElements at: 1) getEtresAttributs: #dent) size ifTrue: [						Transcript cr; show:  'Chaperon rouge - MèreGrand, tu as ',  (((monde get: #litMèreGrand) getElements at: 1) getEtresAttributs: #dent) size asString,  ' grandes dents'].						Smalltalk at: #step put:  7.						(((monde get: #scenario) getEtreAttribut: #loup_0) getEtat: #comportement)  getSemaphore  signal].													  ]]] newProcessWith:  (Array with: ((monde get: #scenario) getEtreAttribut: #chaperon_0))).Transcript clear.					Smalltalk at: #jour put: 1. Smalltalk at: #step put: 0.(monde get: #scenario) go